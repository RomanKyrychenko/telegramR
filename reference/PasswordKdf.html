<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PasswordKdf Class — PasswordKdf • telegramR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PasswordKdf Class — PasswordKdf"><meta name="description" content="An R6 class for handling password key derivation functions (KDF) as per Telegram's specifications.
This class provides utility methods for checking modular exponentiation, XOR operations, PBKDF2 hashing,
and computing password hashes and digests."><meta property="og:description" content="An R6 class for handling password key derivation functions (KDF) as per Telegram's specifications.
This class provides utility methods for checking modular exponentiation, XOR operations, PBKDF2 hashing,
and computing password hashes and digests."><meta property="og:image" content="https://romankyrychenko.github.io/telegramR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">telegramR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>PasswordKdf Class</h1>

      <div class="d-none name"><code>PasswordKdf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>An R6 class for handling password key derivation functions (KDF) as per Telegram's specifications.
This class provides utility methods for checking modular exponentiation, XOR operations, PBKDF2 hashing,
and computing password hashes and digests.</p>
    </div>


    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-PasswordKdf-is_good_mod_exp_first"><code>PasswordKdf$is_good_mod_exp_first()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-xor"><code>PasswordKdf$xor()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-pbkdf2sha512"><code>PasswordKdf$pbkdf2sha512()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-compute_hash"><code>PasswordKdf$compute_hash()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-compute_digest"><code>PasswordKdf$compute_digest()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-check_prime_and_good"><code>PasswordKdf$check_prime_and_good()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-check_prime_and_good_check"><code>PasswordKdf$check_prime_and_good_check()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-is_good_large"><code>PasswordKdf$is_good_large()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-num_bytes_for_hash"><code>PasswordKdf$num_bytes_for_hash()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-big_num_for_hash"><code>PasswordKdf$big_num_for_hash()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-sha256"><code>PasswordKdf$sha256()</code></a></p></li>
<li><p><a href="#method-PasswordKdf-clone"><code>PasswordKdf$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-PasswordKdf-is_good_mod_exp_first"></a><div class="section">
<h3 id="method-is-good-mod-exp-first-">Method <code><a href="is_good_mod_exp_first.html">is_good_mod_exp_first()</a></code><a class="anchor" aria-label="anchor" href="#method-is-good-mod-exp-first-"></a></h3>
<p>Check if a modular exponentiation result is good for the first check.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">is_good_mod_exp_first</span><span class="op">(</span><span class="va">modexp</span>, <span class="va">prime</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>modexp</code></dt>
<dd><p>A big integer representing the modular exponentiation result.</p></dd>


<dt><code>prime</code></dt>
<dd><p>A big integer representing the prime modulus.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A logical value indicating if the check passes.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-xor"></a><div class="section">
<h3 id="method-xor-">Method <code><a href="https://rdrr.io/r/base/Logic.html" class="external-link">xor()</a></code><a class="anchor" aria-label="anchor" href="#method-xor-"></a></h3>
<p>Perform XOR operation on two byte vectors.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">xor</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>a</code></dt>
<dd><p>A raw vector (bytes).</p></dd>


<dt><code>b</code></dt>
<dd><p>A raw vector (bytes).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>A raw vector of the XOR result.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-pbkdf2sha512"></a><div class="section">
<h3 id="method-pbkdf-sha-">Method <code>pbkdf2sha512()</code><a class="anchor" aria-label="anchor" href="#method-pbkdf-sha-"></a></h3>
<p>Compute PBKDF2 with SHA512.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">pbkdf2sha512</span><span class="op">(</span><span class="va">password</span>, <span class="va">salt</span>, <span class="va">iterations</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>password</code></dt>
<dd><p>A raw vector representing the password.</p></dd>


<dt><code>salt</code></dt>
<dd><p>A raw vector representing the salt.</p></dd>


<dt><code>iterations</code></dt>
<dd><p>An integer for the number of iterations.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A raw vector of the derived key.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-compute_hash"></a><div class="section">
<h3 id="method-compute-hash-">Method <code>compute_hash()</code><a class="anchor" aria-label="anchor" href="#method-compute-hash-"></a></h3>
<p>Compute the hash for the password KDF algorithm.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">compute_hash</span><span class="op">(</span><span class="va">algo</span>, <span class="va">password</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>algo</code></dt>
<dd><p>An object of type PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow.</p></dd>


<dt><code>password</code></dt>
<dd><p>A string representing the password.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A raw vector of the computed hash.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-compute_digest"></a><div class="section">
<h3 id="method-compute-digest-">Method <code>compute_digest()</code><a class="anchor" aria-label="anchor" href="#method-compute-digest-"></a></h3>
<p>Compute the digest for the password KDF algorithm.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">compute_digest</span><span class="op">(</span><span class="va">algo</span>, <span class="va">password</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>algo</code></dt>
<dd><p>An object of type PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow.</p></dd>


<dt><code>password</code></dt>
<dd><p>A string representing the password.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>A raw vector of the computed digest.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-check_prime_and_good"></a><div class="section">
<h3 id="method-check-prime-and-good-">Method <code><a href="check_prime_and_good.html">check_prime_and_good()</a></code><a class="anchor" aria-label="anchor" href="#method-check-prime-and-good-"></a></h3>
<p>Check if the prime and generator are good.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">check_prime_and_good</span><span class="op">(</span><span class="va">prime_bytes</span>, <span class="va">g</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>prime_bytes</code></dt>
<dd><p>A raw vector representing the prime in bytes.</p></dd>


<dt><code>g</code></dt>
<dd><p>An integer representing the generator.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-PasswordKdf-check_prime_and_good_check"></a><div class="section">
<h3 id="method-check-prime-and-good-check-">Method <code><a href="check_prime_and_good_check.html">check_prime_and_good_check()</a></code><a class="anchor" aria-label="anchor" href="#method-check-prime-and-good-check-"></a></h3>
<p>Check if the prime and generator are good with detailed checks.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">check_prime_and_good_check</span><span class="op">(</span><span class="va">prime</span>, <span class="va">g</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>prime</code></dt>
<dd><p>An integer representing the prime.</p></dd>


<dt><code>g</code></dt>
<dd><p>An integer representing the generator.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-PasswordKdf-is_good_large"></a><div class="section">
<h3 id="method-is-good-large-">Method <code><a href="is_good_large.html">is_good_large()</a></code><a class="anchor" aria-label="anchor" href="#method-is-good-large-"></a></h3>
<p>Check if a number is good and large.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">is_good_large</span><span class="op">(</span><span class="va">number</span>, <span class="va">p</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>number</code></dt>
<dd><p>An integer representing the number to check.</p></dd>


<dt><code>p</code></dt>
<dd><p>An integer representing the prime modulus.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>A logical value indicating if the check passes.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-num_bytes_for_hash"></a><div class="section">
<h3 id="method-num-bytes-for-hash-">Method <code><a href="num_bytes_for_hash.html">num_bytes_for_hash()</a></code><a class="anchor" aria-label="anchor" href="#method-num-bytes-for-hash-"></a></h3>
<p>Prepare bytes for hashing by padding.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">num_bytes_for_hash</span><span class="op">(</span><span class="va">number</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>number</code></dt>
<dd><p>A raw vector representing the number in bytes.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>A raw vector padded to SIZE_FOR_HASH bytes.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-big_num_for_hash"></a><div class="section">
<h3 id="method-big-num-for-hash-">Method <code><a href="big_num_for_hash.html">big_num_for_hash()</a></code><a class="anchor" aria-label="anchor" href="#method-big-num-for-hash-"></a></h3>
<p>Convert a big integer to bytes for hashing.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">big_num_for_hash</span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>g</code></dt>
<dd><p>An integer to convert.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>A raw vector of the big-endian bytes.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-sha256"></a><div class="section">
<h3 id="method-sha-">Method <code><a href="sha256.html">sha256()</a></code><a class="anchor" aria-label="anchor" href="#method-sha-"></a></h3>
<p>Compute SHA256 hash of concatenated inputs.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">sha256</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Raw vectors to hash.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>A raw vector of the SHA256 digest.</p>
</div>

</div><p></p><hr><a id="method-PasswordKdf-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PasswordKdf</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roman Kyrychenko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

