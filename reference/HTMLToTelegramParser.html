<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HTMLToTelegramParser — HTMLToTelegramParser • telegramR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="HTMLToTelegramParser — HTMLToTelegramParser"><meta name="description" content="Walks an HTML fragment and builds a plain text string and a list of
telegram-style message entities."><meta property="og:description" content="Walks an HTML fragment and builds a plain text string and a list of
telegram-style message entities."><meta property="og:image" content="https://romankyrychenko.github.io/telegramR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">telegramR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/download-data.html">Downloading Channel Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>HTMLToTelegramParser</h1>

      <div class="d-none name"><code>HTMLToTelegramParser.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Walks an HTML fragment and builds a plain text string and a list of
telegram-style message entities.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Traverses the HTML node tree, tracking active tags and their metadata to
  construct Telegram message entities (bold, italic, underline, strike,
  blockquote, code, preformatted, links, custom emoji). Maintains accumulated
  text while adjusting entity offsets and lengths, handling special cases such
  as language hints in `&lt;pre&gt;&lt;code&gt;` blocks and anchored URLs.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Wraps the provided fragment in a `&lt;div&gt;` before parsing to satisfy
  `xml2::read_html`, and automatically finalizes open entities as tags close.</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>text</code></dt>
<dd><p>accumulated plain text</p></dd>


<dt><code>entities</code></dt>
<dd><p>list of entity lists</p></dd>


<dt><code>building_entities</code></dt>
<dd><p>named list of entities currently being built</p></dd>


<dt><code>open_tags</code></dt>
<dd><p>stack of currently open tags</p></dd>


<dt><code>open_tags_meta</code></dt>
<dd><p>stack of metadata associated with open tags</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-HTMLToTelegramParser-new"><code>HTMLToTelegramParser$new()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-push_tag"><code>HTMLToTelegramParser$push_tag()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-pop_tag"><code>HTMLToTelegramParser$pop_tag()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-current_tag"><code>HTMLToTelegramParser$current_tag()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-current_meta"><code>HTMLToTelegramParser$current_meta()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-start_element"><code>HTMLToTelegramParser$start_element()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-handle_text"><code>HTMLToTelegramParser$handle_text()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-end_element"><code>HTMLToTelegramParser$end_element()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-parse_node"><code>HTMLToTelegramParser$parse_node()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-feed"><code>HTMLToTelegramParser$feed()</code></a></p></li>
<li><p><a href="#method-HTMLToTelegramParser-clone"><code>HTMLToTelegramParser$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-HTMLToTelegramParser-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initializes the parser state.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/HTMLToTelegramParser.html">HTMLToTelegramParser</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A new instance of HTMLToTelegramParser.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-push_tag"></a><div class="section">
<h3 id="method-push-tag-">Method <code>push_tag()</code><a class="anchor" aria-label="anchor" href="#method-push-tag-"></a></h3>
<p>Push a tag and optional metadata onto the open tags stack.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">push_tag</span><span class="op">(</span><span class="va">tag</span>, meta <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>tag</code></dt>
<dd><p>The tag name to push.</p></dd>


<dt><code>meta</code></dt>
<dd><p>Optional metadata associated with the tag.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>None.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-pop_tag"></a><div class="section">
<h3 id="method-pop-tag-">Method <code>pop_tag()</code><a class="anchor" aria-label="anchor" href="#method-pop-tag-"></a></h3>
<p>Pop the top tag and its metadata from the open tags stack.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">pop_tag</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A list containing the popped tag and its metadata, or NULL if the stack</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-current_tag"></a><div class="section">
<h3 id="method-current-tag-">Method <code>current_tag()</code><a class="anchor" aria-label="anchor" href="#method-current-tag-"></a></h3>
<p>Get the current top tag from the open tags stack.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">current_tag</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>The top tag name, or NULL if the stack is empty.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-current_meta"></a><div class="section">
<h3 id="method-current-meta-">Method <code>current_meta()</code><a class="anchor" aria-label="anchor" href="#method-current-meta-"></a></h3>
<p>Get the current top metadata from the open tags stack.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">current_meta</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>The top metadata value, or NULL if the stack is empty.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-start_element"></a><div class="section">
<h3 id="method-start-element-">Method <code>start_element()</code><a class="anchor" aria-label="anchor" href="#method-start-element-"></a></h3>
<p>Handle the start of an HTML element, updating state and building entities as needed.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">start_element</span><span class="op">(</span><span class="va">tag</span>, <span class="va">attrs</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>tag</code></dt>
<dd><p>The name of the HTML tag.</p></dd>


<dt><code>attrs</code></dt>
<dd><p>A named list of attributes for the tag.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>None.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-handle_text"></a><div class="section">
<h3 id="method-handle-text-">Method <code>handle_text()</code><a class="anchor" aria-label="anchor" href="#method-handle-text-"></a></h3>
<p>Handle text nodes, updating accumulated text and entity lengths.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">handle_text</span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>text</code></dt>
<dd><p>The text content to handle.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>None.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-end_element"></a><div class="section">
<h3 id="method-end-element-">Method <code>end_element()</code><a class="anchor" aria-label="anchor" href="#method-end-element-"></a></h3>
<p>Handle the end of an HTML element, finalizing any associated entities.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">end_element</span><span class="op">(</span><span class="va">tag</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>tag</code></dt>
<dd><p>The name of the HTML tag.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>None.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-parse_node"></a><div class="section">
<h3 id="method-parse-node-">Method <code>parse_node()</code><a class="anchor" aria-label="anchor" href="#method-parse-node-"></a></h3>
<p>Recursively parse an XML node and its children.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">parse_node</span><span class="op">(</span><span class="va">node</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>node</code></dt>
<dd><p>The XML node to parse.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>None.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-feed"></a><div class="section">
<h3 id="method-feed-">Method <code>feed()</code><a class="anchor" aria-label="anchor" href="#method-feed-"></a></h3>
<p>Parse an HTML fragment, updating the parser state with text and entities.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">feed</span><span class="op">(</span><span class="va">html_fragment</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>html_fragment</code></dt>
<dd><p>A character string containing the HTML fragment to parse.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-9">Returns<a class="anchor" aria-label="anchor" href="#returns-9"></a></h4>
<p>None.</p>
</div>

</div><p></p><hr><a id="method-HTMLToTelegramParser-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">HTMLToTelegramParser</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roman Kyrychenko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

